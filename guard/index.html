<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å±±æµ·Guard | æœ›å±±æµ·(See Mountain Seaï¼‰- è‡´åŠ›äºæ‰“é€ å¥½ç”¨çš„Javaç»„ä»¶ä»“åº“</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="./SeeMountainSea.png">
    <meta name="description" content="è¿ç¥å…½ï¼Œæœ›å±±æµ·ï¼Œé•‡è‹ç©¹ã€‚">
    
    <link rel="preload" href="/assets/css/0.styles.11fa4f0a.css" as="style"><link rel="preload" href="/assets/js/app.70ce5912.js" as="script"><link rel="preload" href="/assets/js/3.9490caa6.js" as="script"><link rel="preload" href="/assets/js/1.ef43800b.js" as="script"><link rel="preload" href="/assets/js/13.0082dea9.js" as="script"><link rel="prefetch" href="/assets/js/10.4026a63d.js"><link rel="prefetch" href="/assets/js/11.b192518e.js"><link rel="prefetch" href="/assets/js/12.7b6eeb14.js"><link rel="prefetch" href="/assets/js/14.3883bed3.js"><link rel="prefetch" href="/assets/js/15.da6aaed6.js"><link rel="prefetch" href="/assets/js/16.6f5b139c.js"><link rel="prefetch" href="/assets/js/17.507f3df7.js"><link rel="prefetch" href="/assets/js/4.ddb8ad91.js"><link rel="prefetch" href="/assets/js/5.bb200a59.js"><link rel="prefetch" href="/assets/js/6.d7ae1787.js"><link rel="prefetch" href="/assets/js/7.cc17a580.js"><link rel="prefetch" href="/assets/js/8.b7d18a27.js"><link rel="prefetch" href="/assets/js/9.8cde4f9f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.11fa4f0a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-5bb33761><div data-v-5bb33761><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-5bb33761 data-v-5bb33761><h3 class="title" data-v-59e6cb88>æœ›å±±æµ·(See Mountain Seaï¼‰- è‡´åŠ›äºæ‰“é€ å¥½ç”¨çš„Javaç»„ä»¶ä»“åº“</h3> <p class="description" data-v-59e6cb88>è¿ç¥å…½ï¼Œæœ›å±±æµ·ï¼Œé•‡è‹ç©¹ã€‚</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
        Â Â 
        <span data-v-59e6cb88>2020 - </span>
        2024
      </a></span></div></div> <div class="hide" data-v-5bb33761><header class="navbar" data-v-5bb33761><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="./SeeMountainSea.png" alt="æœ›å±±æµ·(See Mountain Seaï¼‰- è‡´åŠ›äºæ‰“é€ å¥½ç”¨çš„Javaç»„ä»¶ä»“åº“" class="logo"> <span class="site-name">æœ›å±±æµ·(See Mountain Seaï¼‰- è‡´åŠ›äºæ‰“é€ å¥½ç”¨çš„Javaç»„ä»¶ä»“åº“</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  ä¸»é¡µ
</a></div><div class="nav-item"><a href="/guard/" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="iconfont reco-home"></i>
  å±±æµ·Guard
</a></div><div class="nav-item"><a href="/power/" class="nav-link"><i class="iconfont reco-document"></i>
  å±±æµ·Power
</a></div><div class="nav-item"><a href="/logs/" class="nav-link"><i class="iconfont reco-document"></i>
  å±±æµ·Log
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      æ›´å¤šç»„ä»¶
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/formrules/" class="nav-link"><i class="undefined"></i>
  å±±æµ·FormRule
</a></li><li class="dropdown-item"><!----> <a href="/dbdoc/" class="nav-link"><i class="undefined"></i>
  å±±æµ·DBDoc
</a></li><li class="dropdown-item"><!----> <a href="/productivity/" class="nav-link"><i class="undefined"></i>
  å±±æµ·ç”Ÿäº§åŠ›Doc
</a></li></ul></div></div><div class="nav-item"><a href="/zh/guide/" class="nav-link"><i class="iconfont reco-document"></i>
  å…³äºå±±æµ·
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-5bb33761></div> <aside class="sidebar" data-v-5bb33761><div class="personal-info-wrapper" data-v-1fad0c41 data-v-5bb33761><!----> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>7</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>0</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  ä¸»é¡µ
</a></div><div class="nav-item"><a href="/guard/" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="iconfont reco-home"></i>
  å±±æµ·Guard
</a></div><div class="nav-item"><a href="/power/" class="nav-link"><i class="iconfont reco-document"></i>
  å±±æµ·Power
</a></div><div class="nav-item"><a href="/logs/" class="nav-link"><i class="iconfont reco-document"></i>
  å±±æµ·Log
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      æ›´å¤šç»„ä»¶
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/formrules/" class="nav-link"><i class="undefined"></i>
  å±±æµ·FormRule
</a></li><li class="dropdown-item"><!----> <a href="/dbdoc/" class="nav-link"><i class="undefined"></i>
  å±±æµ·DBDoc
</a></li><li class="dropdown-item"><!----> <a href="/productivity/" class="nav-link"><i class="undefined"></i>
  å±±æµ·ç”Ÿäº§åŠ›Doc
</a></li></ul></div></div><div class="nav-item"><a href="/zh/guide/" class="nav-link"><i class="iconfont reco-document"></i>
  å…³äºå±±æµ·
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-5bb33761><h3 class="title" data-v-59e6cb88>å±±æµ·Guard</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
        Â Â 
        <span data-v-59e6cb88>2020 - </span>
        2024
      </a></span></div></div> <div data-v-5bb33761><div data-v-5bb33761><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">å±±æµ·Guard</h1> <div data-v-8a445198><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><div><p>åŸºäºSpringBoot çš„é€šç”¨Webå®‰å…¨ç»„ä»¶</p> <p>Based SpringBoot Web Security components</p> <p><a href="https://github.com/SeeMountainSea/shanhai-guard-spring-boot-starter/releases/latest"><img alt="GitHub release (latest by date)" src="https://img.shields.io/github/v/release/SeeMountainSea/shanhai-guard-spring-boot-starter"></a> <a href="https://github.com/SeeMountainSea/shanhai-guard-spring-boot-starter/issues"><img alt="GitHub closed issues" src="https://img.shields.io/github/issues/SeeMountainSea/shanhai-guard-spring-boot-starter?color=009688"></a> <a href="https://github.com/topics/java"><img alt="GitHub top language" src="https://img.shields.io/github/languages/top/SeeMountainSea/shanhai-guard-spring-boot-starter?color=eb8031"></a> <br> <a href="https://github.com/SeeMountainSea/shanhai-guard-spring-boot-starter/find/master"><img alt="GitHub Code Size" src="https://img.shields.io/github/languages/code-size/SeeMountainSea/shanhai-guard-spring-boot-starter?color=795548"></a> <a href="https://github.com/SeeMountainSea/shanhai-guard-spring-boot-starter/find/master"><img alt="GitHub Code Lines" src="https://img.shields.io/tokei/lines/github/SeeMountainSea/shanhai-guard-spring-boot-starter?color=37474F"></a> <a href="https://github.com/SeeMountainSea/shanhai-guard-spring-boot-starter/blob/master/LICENSE"><img alt="GitHub License" src="https://img.shields.io/github/license/SeeMountainSea/shanhai-guard-spring-boot-starter?color=534BAE"></a></p></div> <h2 id="ç»„ä»¶èƒ½åŠ›"><a href="#ç»„ä»¶èƒ½åŠ›" class="header-anchor">#</a> ç»„ä»¶èƒ½åŠ›</h2> <ul><li>æ”¯æŒæ–‡ä»¶ä¸Šä¼ å®‰å…¨æ£€æµ‹ ï¼ˆæ”¯æŒå…¨å±€æ ¡éªŒã€å•ä¸ªæ–¹æ³•æ ¡éªŒã€è‡ªå®šä¹‰æ ¡éªŒã€ZIPæ‰«ææ ¡éªŒç­‰å¤šç§ç­–ç•¥ï¼‰</li> <li>æ”¯æŒåŸºäºMybatis-Plusåœ¨è¿›è¡Œæ•°æ®å­—æ®µçº§åŠ å¯†ä¸è„±æ•ï¼ˆæ”¯æŒè‡ªè¡Œæ‰©å±•å®ç°ç›¸å…³ç®—æ³•ï¼Œå¦‚å¯¹æ¥å¯†ç æœºæˆ–åŠ å¯†æœåŠ¡ï¼‰</li> <li>æ”¯æŒSQLæ³¨å…¥&amp;XSSæ³¨å…¥å®‰å…¨æ£€æµ‹</li> <li>æ”¯æŒå¯†ç å¤æ‚åº¦æ£€éªŒ ï¼ˆæ”¯æŒæ•°å­—ã€å¤§å°å†™å­—æ¯ã€é”®ç›˜æ’åºã€é•¿åº¦ã€ç›¸åŒå­—ç¬¦ã€è¿ç»­å­—ç¬¦ç­‰å¤šç§ç­–ç•¥ï¼‰</li> <li>æ”¯æŒSpringBoot POSTè¯·æ±‚æŠ¥æ–‡åŠ å¯†ã€å“åº”æŠ¥æ–‡åŠ å¯†</li> <li>æ”¯æŒSpringBoot å“åº”æŠ¥æ–‡è¿›è¡Œå­—æ®µçº§æ•°æ®è„±æ•ï¼ˆæ”¯æŒè‡ªè¡Œå®ç°è„±æ•ç®—æ³•ï¼‰</li> <li>æ”¯æŒå¯¹SpringBooté…ç½®æ–‡ä»¶ä»»æ„å‚æ•°è¿›è¡Œå‚æ•°åŠ å¯†ï¼ˆæ”¯æŒè‡ªè¡Œæ‰©å±•åŠ å¯†ç®—æ³•ï¼‰</li> <li>æ”¯æŒå¯¹å…¨é‡å‚æ•°è¿›è¡Œæ•æ„Ÿè¯æ£€æŸ¥ä¸è¿‡æ»¤</li></ul> <h2 id="_1-å¼•å…¥ä¾èµ–"><a href="#_1-å¼•å…¥ä¾èµ–" class="header-anchor">#</a> 1.å¼•å…¥ä¾èµ–</h2> <div class="language-xml extra-class"><pre class="language-xml"><code>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.wangshanhai.guard<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>shanhai-guard-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${shanhaiguard.last.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_2-å¯ç”¨shanhaiguardå®‰å…¨é˜²æŠ¤ç»„ä»¶"><a href="#_2-å¯ç”¨shanhaiguardå®‰å…¨é˜²æŠ¤ç»„ä»¶" class="header-anchor">#</a> 2.å¯ç”¨ShanHaiGuardå®‰å…¨é˜²æŠ¤ç»„ä»¶</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableShanHaiGuard</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShanHaiGuardConfig</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_3-ç»„ä»¶è¯´æ˜"><a href="#_3-ç»„ä»¶è¯´æ˜" class="header-anchor">#</a> 3.ç»„ä»¶è¯´æ˜</h2> <h3 id="_3-1-æ–‡ä»¶ä¸Šä¼ æ£€æµ‹"><a href="#_3-1-æ–‡ä»¶ä¸Šä¼ æ£€æµ‹" class="header-anchor">#</a> 3.1 æ–‡ä»¶ä¸Šä¼ æ£€æµ‹</h3> <p>é…ç½®å‚æ•°å¦‚ä¸‹</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">fileguard</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token comment">#å¯ç”¨ç»„ä»¶</span>
    <span class="token key atrule">pathPatterns</span><span class="token punctuation">:</span> <span class="token comment">#æ£€æµ‹èŒƒå›´</span>
      <span class="token punctuation">-</span> <span class="token string">'/**'</span>
    <span class="token key atrule">suffix</span><span class="token punctuation">:</span> jpg<span class="token punctuation">,</span>gif<span class="token punctuation">,</span>png<span class="token punctuation">,</span>ico<span class="token punctuation">,</span>bmp<span class="token punctuation">,</span>jpeg <span class="token comment">#æ–‡ä»¶ä¸Šä¼ ç™½åå•</span>
    <span class="token key atrule">logTarce</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token comment">#å¯ç”¨è·Ÿè¸ªæ—¥å¿—</span>
</code></pre></div><p>æ­¤å¤„çš„é…ç½®ä¸ºå…¨å±€æ€§é…ç½®ï¼Œå¯¹äºå•ä¸ªæ–¹æ³•çš„æ ¡éªŒï¼Œå¯ä»¥ä½¿ç”¨@FileGuardæ·»åŠ æ ¡éªŒï¼Œå‚è€ƒä¸‹é¢æ ·ä¾‹çš„ä½¿ç”¨æ–¹å¼ï¼š</p> <p>1ï¼‰è·³è¿‡æ£€éªŒ</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@FileGuard</span><span class="token punctuation">(</span>skip  <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre></div><p>2ï¼‰å®ç°è‡ªå®šä¹‰è§„åˆ™æ£€éªŒ</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@FileGuard</span><span class="token punctuation">(</span>checkByRule <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre></div><p>æ³¨ï¼šå¦‚æœå¯ç”¨è¯¥å‚æ•°ï¼Œéœ€è¦å®ç°FileGuardRuleDefServiceï¼Œå¦åˆ™å°†æ— æ³•ä¸Šä¼ æ–‡ä»¶ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileGuardRuleDefServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">FileGuardRuleDefService</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * è¡¨å•keyåŠå¯¹åº”çš„æ–‡ä»¶
     * @param files æ–‡ä»¶æ¸…å•
     * @return
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isSafe</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">MultipartFile</span><span class="token punctuation">&gt;</span></span> files<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>3ï¼‰é€šè¿‡æ–‡ä»¶åç¼€æ ¡éªŒ(GuardType.SUFFIX)</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * æ–‡ä»¶ä¸Šä¼ æµ‹è¯•æ ·ä¾‹
 * @param request
 * @return
 */</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/file/suffix/upload&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@FileGuard</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;åªèƒ½ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶&quot;</span><span class="token punctuation">,</span>type <span class="token operator">=</span> <span class="token class-name">FileGuard<span class="token punctuation">.</span>GuardType</span><span class="token punctuation">.</span><span class="token constant">SUFFIX</span><span class="token punctuation">,</span>supportedSuffixes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;png&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jpg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jpeg&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">suffix</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;[file-upload-api]-name:{},contentType:{},size:{}&quot;</span><span class="token punctuation">,</span>file<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>file<span class="token punctuation">.</span><span class="token function">getContentType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>file<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>4)é€šè¿‡äºŒè¿›åˆ¶æ–‡ä»¶å¤´æ£€éªŒ(GuardType.BYTES)</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * æ–‡ä»¶ä¸Šä¼ æµ‹è¯•æ ·ä¾‹
 * @param request
 * @return
 */</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/file/bytes/upload&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@FileGuard</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;åªèƒ½ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶&quot;</span><span class="token punctuation">,</span>type <span class="token operator">=</span> <span class="token class-name">FileGuard<span class="token punctuation">.</span>GuardType</span><span class="token punctuation">.</span><span class="token constant">BYTES</span><span class="token punctuation">,</span>supportedFileTypes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">FileType</span><span class="token punctuation">.</span><span class="token constant">JPEG</span><span class="token punctuation">,</span><span class="token class-name">FileType</span><span class="token punctuation">.</span><span class="token constant">PNG</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">bytes</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;[file-upload-api]-name:{},contentType:{},size:{}&quot;</span><span class="token punctuation">,</span>file<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>file<span class="token punctuation">.</span><span class="token function">getContentType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>file<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>æ³¨ï¼šå•ä¸ªæ–¹æ³•çš„ç™½åå•å¿…é¡»ä¸ºå…¨å±€æ€§ç™½åå•çš„å­é›†</strong></p> <p>5)æ”¯æŒZIPå‹ç¼©åŒ…è‡ªåŠ¨æ‰«ææ£€æµ‹</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">fileguard</span><span class="token punctuation">:</span>
    <span class="token key atrule">zipScan</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token comment">#å¯ç”¨ç»„ä»¶</span>
    <span class="token key atrule">zipSafeSuffixs</span><span class="token punctuation">:</span> jpg<span class="token punctuation">,</span>gif<span class="token punctuation">,</span>png<span class="token punctuation">,</span>ico<span class="token punctuation">,</span>bmp<span class="token punctuation">,</span>jpeg <span class="token comment">#ZIPå‹ç¼©åŒ…å†…æ–‡ä»¶ä¸Šä¼ ç™½åå•</span>
</code></pre></div><p>6)æ’é™¤æŸäº›ç‰¹å®šURIæ ¡éªŒ</p> <div class="language- extra-class"><pre class="language-text"><code>shanhai:
  fileguard:
     excludePathPatterns: 
      - '/**'
</code></pre></div><h3 id="_3-2-å¯†ç å¤æ‚åº¦æ£€æµ‹"><a href="#_3-2-å¯†ç å¤æ‚åº¦æ£€æµ‹" class="header-anchor">#</a> 3.2 å¯†ç å¤æ‚åº¦æ£€æµ‹</h3> <p>é…ç½®å‚æ•°å¦‚ä¸‹</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">passwdguard</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#å¯ç”¨ç»„ä»¶</span>
    <span class="token key atrule">minLength</span><span class="token punctuation">:</span> <span class="token number">4</span> <span class="token comment">#æœ€å°é•¿åº¦</span>
    <span class="token key atrule">maxLength</span><span class="token punctuation">:</span> <span class="token number">10</span> <span class="token comment">#æœ€å¤§é•¿åº¦</span>
    <span class="token key atrule">characterExist</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#åŒ…å«å¤§å°å†™å­—æ¯</span>
    <span class="token key atrule">numberExist</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#åŒ…å«æ•°å­—</span>
    <span class="token key atrule">symbolExist</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#åŒ…å«ç¬¦å·</span>
    <span class="token key atrule">keyboardNotExist</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#ä¸åŒ…å«é”®ç›˜æ’åº</span>
    <span class="token key atrule">allSameNotExist</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#ä¸åŒ…å«ç›¸åŒå­—ç¬¦ï¼ˆæ•°å­—æˆ–å­—æ¯ï¼Œå¦‚111æˆ–aaaï¼‰</span>
    <span class="token key atrule">allSameNum</span><span class="token punctuation">:</span> <span class="token number">3</span> <span class="token comment">#ç›¸åŒå­—ç¬¦æœ€å¤§ä¸ªæ•°</span>
    <span class="token key atrule">seqSameNotExist</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#ä¸åŒ…å«è¿ç»­å­—ç¬¦ï¼ˆæ•°å­—æˆ–å­—æ¯,å¦‚123æˆ–abcï¼‰</span>
    <span class="token key atrule">seqSameNum</span><span class="token punctuation">:</span> <span class="token number">3</span>  <span class="token comment">#è¿ç»­å­—ç¬¦æœ€å¤§ä¸ªæ•°</span>
    
</code></pre></div><p>åœ¨ä¸šåŠ¡æ¨¡å—å¯ä»¥ç›´æ¥ä½¿ç”¨å¯†ç å¤æ‚åº¦æ£€æµ‹æœåŠ¡PasswdServiceï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//æ³¨å…¥æœåŠ¡</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">PasswdService</span> passwdService<span class="token punctuation">;</span>
<span class="token comment">//è°ƒç”¨æœåŠ¡æ–¹æ³•</span>
passwdService<span class="token punctuation">.</span><span class="token function">checkPasswd</span><span class="token punctuation">(</span>passwd<span class="token punctuation">)</span>
</code></pre></div><h3 id="_3-3-sql-xssæ³¨å…¥æ£€æµ‹"><a href="#_3-3-sql-xssæ³¨å…¥æ£€æµ‹" class="header-anchor">#</a> 3.3 SQL&amp;XSSæ³¨å…¥æ£€æµ‹</h3> <p>é…ç½®å‚æ•°å¦‚ä¸‹</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">webguard</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#å¯ç”¨ç»„ä»¶</span>
    <span class="token key atrule">path-patterns</span><span class="token punctuation">:</span> <span class="token comment">#æ£€æµ‹èŒƒå›´</span>
      <span class="token punctuation">-</span> <span class="token string">'/*'</span>
</code></pre></div><h3 id="_3-4-mysqlæ•°æ®å®‰å…¨æ£€æµ‹"><a href="#_3-4-mysqlæ•°æ®å®‰å…¨æ£€æµ‹" class="header-anchor">#</a> 3.4 Mysqlæ•°æ®å®‰å…¨æ£€æµ‹</h3> <p>é…ç½®å‚æ•°å¦‚ä¸‹</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">mysqlguard</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>       <span class="token comment">#å¯ç”¨ç»„ä»¶</span>
    <span class="token key atrule">where-exist</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token comment">#åŒ…å«whereè¯­å¥</span>
    <span class="token key atrule">limit-exist</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token comment">#åŒ…å«limitè¯­å¥</span>
    <span class="token key atrule">query-limit</span><span class="token punctuation">:</span> <span class="token number">20000</span>  <span class="token comment">#limitæ¡æ•°</span>
</code></pre></div><h3 id="_3-5-requestbody-é€šç”¨è§£ç ç»„ä»¶"><a href="#_3-5-requestbody-é€šç”¨è§£ç ç»„ä»¶" class="header-anchor">#</a> 3.5 @RequestBody é€šç”¨è§£ç ç»„ä»¶</h3> <h4 id="_3-5-1-å…¨é‡è¯·æ±‚è§£ç "><a href="#_3-5-1-å…¨é‡è¯·æ±‚è§£ç " class="header-anchor">#</a> 3.5.1 å…¨é‡è¯·æ±‚è§£ç </h4> <p>é…ç½®å‚æ•°å¦‚ä¸‹</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">decodebody</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#å¯ç”¨ç»„ä»¶</span>
</code></pre></div><p>æ³¨ï¼šæ­¤ç»„ä»¶åªæ˜¯åšäº†é€šç”¨æ€§å°è£…ï¼Œå¯¹äºè§£ç é€»è¾‘éœ€è¦è‡ªè¡Œå®ç°æ¥å£DecodeBodyServiceçš„decodeRequestBodyæ–¹æ³•ï¼Œåœ¨è¿›è¡Œæ•°æ®è§£ç æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ¥å£çš„å®ç°æ–¹æ³•è¿›è¡Œè‡ªå®šä¹‰å‚æ•°è§£ç æ“ä½œã€‚</p> <p>æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DecodeBodyService</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * è§£æåŠ å¯†å‚æ•°
     * @param body åŸå§‹æŠ¥æ–‡æ•°æ®
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">decodeRequestBody</span><span class="token punctuation">(</span><span class="token class-name">String</span> body<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¦‚æœéœ€è¦æŸä¸ªè¯·æ±‚ä¸è¿›è¡Œè§£ç æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨æ³¨è§£@DecodeBodyIgnoreè·³è¿‡å¯¹ç›®æ ‡è¯·æ±‚çš„è§£ç æ“ä½œã€‚</p> <h4 id="_3-5-2-æŒ‡å®šè¯·æ±‚è§£ç "><a href="#_3-5-2-æŒ‡å®šè¯·æ±‚è§£ç " class="header-anchor">#</a> 3.5.2 æŒ‡å®šè¯·æ±‚è§£ç </h4> <p>é…ç½®å‚æ•°å¦‚ä¸‹</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">decodebody</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#å¯ç”¨ç»„ä»¶</span>
    <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token number">2</span>      <span class="token comment">#æŒ‡å®šè¯·æ±‚è§£ç æ¨¡å¼ï¼Œé»˜è®¤ä¸ºå…¨é‡è§£ç  mode:1</span>
</code></pre></div><p>ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@DecodeBody</span><span class="token punctuation">(</span>ruleId <span class="token operator">=</span> <span class="token string">&quot;demio&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">decodeOne</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">String</span> body<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> body<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ³¨ï¼šæ­¤ç»„ä»¶åªæ˜¯åšäº†é€šç”¨æ€§å°è£…ï¼Œå¯¹äºè§£ç é€»è¾‘éœ€è¦è‡ªè¡Œå®ç°æ¥å£DecodeBodyServiceçš„decodeRequestBodyæ–¹æ³•ï¼Œåœ¨è¿›è¡Œæ•°æ®è§£ç æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ¥å£çš„å®ç°æ–¹æ³•è¿›è¡Œè‡ªå®šä¹‰å‚æ•°è§£ç æ“ä½œã€‚</p> <p>æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DecodeBodyService</span> <span class="token punctuation">{</span>
    <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">decodeRequestBody</span><span class="token punctuation">(</span><span class="token class-name">String</span> ruleId<span class="token punctuation">,</span><span class="token class-name">String</span> body<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç”¨æˆ·æ ¹æ®ruleIdè¿›è¡Œä¸ªæ€§åŒ–è§£ç ç»„ä»¶å¼€å‘ã€‚</p> <h3 id="_3-6-springbooté…ç½®æ–‡ä»¶å‚æ•°åŠ å¯†"><a href="#_3-6-springbooté…ç½®æ–‡ä»¶å‚æ•°åŠ å¯†" class="header-anchor">#</a> 3.6 SpringBooté…ç½®æ–‡ä»¶å‚æ•°åŠ å¯†</h3> <h4 id="_3-6-1-ä½¿ç”¨å†…ç½®ç®—æ³•å¤„ç†åŠ å¯†å‚æ•°"><a href="#_3-6-1-ä½¿ç”¨å†…ç½®ç®—æ³•å¤„ç†åŠ å¯†å‚æ•°" class="header-anchor">#</a> 3.6.1 ä½¿ç”¨å†…ç½®ç®—æ³•å¤„ç†åŠ å¯†å‚æ•°</h4> <p>å†…ç½®è§£å¯†ç®—æ³•(PBE)é…ç½®æ ·ä¾‹-ï¼ˆè€ç‰ˆæœ¬å®ç°ï¼Œä¸å†æ¨èä½¿ç”¨ï¼‰</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">envdecode</span><span class="token punctuation">:</span>
    <span class="token key atrule">market</span><span class="token punctuation">:</span>
      <span class="token key atrule">algorithm</span><span class="token punctuation">:</span> PBE           <span class="token comment">#ç®—æ³•åç§°</span>
      <span class="token key atrule">pebPasswd</span><span class="token punctuation">:</span> <span class="token string">'20220111'</span>    <span class="token comment">#å¯†é’¥</span>
      <span class="token key atrule">pebSalt</span><span class="token punctuation">:</span> <span class="token string">'XCWT61iHdbg='</span>  <span class="token comment">#ç›å€¼</span>
</code></pre></div><p>å†…ç½®è§£å¯†ç®—æ³•(PBEå®‰å…¨æ¨¡å¼)é…ç½®æ ·ä¾‹</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">envdecode</span><span class="token punctuation">:</span>
    <span class="token key atrule">market</span><span class="token punctuation">:</span>
      <span class="token key atrule">algorithm</span><span class="token punctuation">:</span> PBESafe           <span class="token comment">#ç®—æ³•åç§°</span>
      <span class="token key atrule">pebPasswd</span><span class="token punctuation">:</span> <span class="token string">'20220111'</span>    <span class="token comment">#å¯†é’¥</span>
      <span class="token key atrule">pebSalt</span><span class="token punctuation">:</span> <span class="token string">'XCWT61iHdbg='</span>  <span class="token comment">#ç›å€¼</span>
      <span class="token key atrule">cycleNum</span><span class="token punctuation">:</span> <span class="token number">100000</span>         <span class="token comment">#å¾ªç¯æ¬¡æ•°ï¼ˆå¿…é¡»å¤§äº10000ï¼‰</span>
</code></pre></div><p>å†…ç½®è§£å¯†ç®—æ³•(AES)é…ç½®æ ·ä¾‹</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">envdecode</span><span class="token punctuation">:</span>
    <span class="token key atrule">market</span><span class="token punctuation">:</span>
      <span class="token key atrule">algorithm</span><span class="token punctuation">:</span> AES           <span class="token comment">#ç®—æ³•åç§°</span>
      <span class="token key atrule">key</span><span class="token punctuation">:</span> <span class="token string">'woniucsdnvip8888'</span>  <span class="token comment">#å¯†é’¥ (16å­—èŠ‚)</span>
      <span class="token key atrule">iv</span><span class="token punctuation">:</span> <span class="token string">'bbCGNLlryzHaCL3P'</span>   <span class="token comment">#å‘é‡ (16å­—èŠ‚)</span>
      <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token number">1</span>                  <span class="token comment">#æ¨¡å¼ 1:CBC 2:CFB</span>
</code></pre></div><p>SpringBooté…ç½®å‚æ•°åŠ å¯†è¯´æ˜ï¼š</p> <p>1ï¼‰æ‰€æœ‰åŠ å¯†å‚æ•°çš„Valueå€¼ä»¥**envdecode:ğŸ˜—*æ‰“å¤´ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼š</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">app</span><span class="token punctuation">:</span>
  <span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'envdecode::iezthxHWDp/fhXYXZSjhVw=='</span>
</code></pre></div><p>2ï¼‰åŠ å¯†ç»“æœç”Ÿæˆæ ·ä¾‹</p> <p>PBEåŠ å¯†ç®—æ³•</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">//ç”Ÿæˆç›å€¼</span>
    <span class="token class-name">String</span> salt<span class="token operator">=</span> <span class="token class-name">PBEUtils</span><span class="token punctuation">.</span><span class="token function">initSalt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è‡ªå®šä¹‰å¯†é’¥</span>
    <span class="token class-name">String</span> passwd<span class="token operator">=</span><span class="token string">&quot;20220111&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//å¾…åŠ å¯†å‚æ•°å€¼</span>
    <span class="token class-name">String</span> val<span class="token operator">=</span><span class="token string">&quot;zhangsanxxx1&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> encryptStr<span class="token operator">=</span><span class="token class-name">PBEUtils</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>passwd<span class="token punctuation">,</span>salt<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//åŠ å¯†ç»“æœ</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>salt<span class="token operator">+</span><span class="token string">&quot;:&quot;</span><span class="token operator">+</span>encryptStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è§£å¯†ç»“æœ</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">PBEUtils</span><span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>encryptStr<span class="token punctuation">,</span>passwd<span class="token punctuation">,</span>salt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>PBEå®‰å…¨æ¨¡å¼åŠ å¯†ç®—æ³•</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">//ç”Ÿæˆç›å€¼</span>
    <span class="token class-name">String</span> salt<span class="token operator">=</span> <span class="token class-name">PBEUtils</span><span class="token punctuation">.</span><span class="token function">initSalt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è‡ªå®šä¹‰å¯†é’¥</span>
    <span class="token class-name">String</span> passwd<span class="token operator">=</span><span class="token string">&quot;20220111&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//å¾…åŠ å¯†å‚æ•°å€¼</span>
    <span class="token class-name">String</span> val<span class="token operator">=</span><span class="token string">&quot;zhangsanxxx1&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> encryptStr<span class="token operator">=</span><span class="token class-name">PBEUtils</span><span class="token punctuation">.</span><span class="token function">encryptSafe</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>passwd<span class="token punctuation">,</span>salt<span class="token punctuation">,</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//åŠ å¯†ç»“æœ</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>salt<span class="token operator">+</span><span class="token string">&quot;:&quot;</span><span class="token operator">+</span>encryptStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è§£å¯†ç»“æœ</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">PBEUtils</span><span class="token punctuation">.</span><span class="token function">decryptSafe</span><span class="token punctuation">(</span>encryptStr<span class="token punctuation">,</span>passwd<span class="token punctuation">,</span>salt<span class="token punctuation">,</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>AESåŠ å¯†ç®—æ³•</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> text <span class="token operator">=</span> <span class="token string">&quot;å—¨ï¼Œæ‚¨å¥½ï¼&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> key  <span class="token operator">=</span> <span class="token string">&quot;woniucsdnvip8888&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> iv  <span class="token operator">=</span> <span class="token function">getIV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
        <span class="token class-name">String</span> encryptTextCBC <span class="token operator">=</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> <span class="token constant">AES_CBC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CBC åŠ å¯†IVï¼š&quot;</span> <span class="token operator">+</span> iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CBC åŠ å¯†åå†…å®¹ï¼š&quot;</span> <span class="token operator">+</span> encryptTextCBC<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CBC è§£å¯†åå†…å®¹ï¼š&quot;</span> <span class="token operator">+</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>encryptTextCBC<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> <span class="token constant">AES_CBC</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> encryptTextCFB <span class="token operator">=</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> <span class="token constant">AES_CFB</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CFB åŠ å¯†IVï¼š&quot;</span> <span class="token operator">+</span> iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CFB åŠ å¯†åå†…å®¹ï¼š&quot;</span> <span class="token operator">+</span> encryptTextCFB<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CFB è§£å¯†åå†…å®¹ï¼š&quot;</span> <span class="token operator">+</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>encryptTextCFB<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> <span class="token constant">AES_CFB</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-6-2-è‡ªå®šä¹‰å¤„ç†åŠ å¯†å‚æ•°"><a href="#_3-6-2-è‡ªå®šä¹‰å¤„ç†åŠ å¯†å‚æ•°" class="header-anchor">#</a> 3.6.2 è‡ªå®šä¹‰å¤„ç†åŠ å¯†å‚æ•°</h4> <p>é¦–å…ˆéœ€è¦å®ç°ä¸€ä¸ªè‡ªå·±çš„å‚æ•°è§£å¯†ç±»ï¼Œè¦æ±‚è¯¥ç±»å¿…é¡»ç»§æ‰¿äºPropertyDecodeï¼Œå¹¶å®ç°å…¶å®šä¹‰çš„è§£å¯†æ–¹æ³•getPropertyï¼ŒPropertyDecodedå®šä¹‰å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span>  <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">PropertyDecode</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * è‡ªå®šä¹‰è§£æç®—æ³•
     * @param envProperties é€šç”¨é…ç½®å‚æ•° 
     * @param configProperties å¾…è§£å¯†å±æ€§key:value
     * @return
     */</span>
    <span class="token annotation punctuation">@Nullable</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">Properties</span> <span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token class-name">Properties</span> envProperties<span class="token punctuation">,</span><span class="token class-name">Properties</span> configProperties<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>æ³¨ï¼šSpringBooté…ç½®æ–‡ä»¶ä¸­shanhai.envdecodeæ‰“å¤´çš„å‚æ•°éƒ½ä¼šä¼ é€’åˆ°envPropertiesä¸­ï¼Œå¯ä»¥è‡ªå·±è·å–è‡ªå·±é…ç½®çš„è‡ªå®šä¹‰å‚æ•°ã€‚</strong></p> <p>åœ¨SpringBootçš„é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šè‡ªå·±æ–°å¢çš„è‡ªå®šä¹‰è§£å¯†ç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
 <span class="token key atrule">envdecode</span><span class="token punctuation">:</span>
    <span class="token comment"># è‡ªå®šä¹‰è§£å¯†ç±»çš„ä¼˜å…ˆçº§æœ€é«˜</span>
    <span class="token key atrule">className</span><span class="token punctuation">:</span> <span class="token string">'com.xxx.RSAPropertyDecode'</span>
</code></pre></div><p><strong>æ³¨ ï¼šå¦‚æœæ—¢å­˜åœ¨è‡ªå®šä¹‰è§£å¯†ç±»ï¼Œåˆå­˜åœ¨PBEè§£å¯†é…ç½®çš„ï¼Œè‡ªå®šä¹‰è§£å¯†ç±»ä¼˜å…ˆçº§æœ€é«˜ã€‚</strong></p> <h3 id="_3-7-åŸºäºmybatis-plusè¿›è¡Œå­—æ®µçº§åŠ è§£å¯†ä¸æ•°æ®è„±æ•"><a href="#_3-7-åŸºäºmybatis-plusè¿›è¡Œå­—æ®µçº§åŠ è§£å¯†ä¸æ•°æ®è„±æ•" class="header-anchor">#</a> 3.7 åŸºäºMybatis-Plusè¿›è¡Œå­—æ®µçº§åŠ è§£å¯†ä¸æ•°æ®è„±æ•</h3> <table><thead><tr><th>æ•°æ®å¤„ç†</th> <th>ç”Ÿæ•ˆæ¨¡å¼</th> <th>å¤‡æ³¨</th></tr></thead> <tbody><tr><td>æ•°æ®åŠ å¯†</td> <td>æ–°å¢|ä¿®æ”¹|æŸ¥è¯¢</td> <td>ä¸æ”¯æŒ QueryWrapperè¿›è¡ŒæŸ¥è¯¢</td></tr> <tr><td>æ•°æ®è§£å¯†</td> <td>æŸ¥è¯¢</td> <td></td></tr> <tr><td>æ•°æ®è„±æ•</td> <td>æ–°å¢|ä¿®æ”¹|æŸ¥è¯¢</td> <td>å½“æ‰§è¡Œæ–°å¢|ä¿®æ”¹æ“ä½œæ—¶ï¼Œè„±æ•ä¸åŠ å¯†ä¸å»ºè®®åŒæ—¶ä½¿ç”¨</td></tr></tbody></table> <p>æ•°æ®ç”Ÿæ•ˆèŒƒå›´</p> <table><thead><tr><th>èŒƒå›´å®šä¹‰</th> <th>ä½œç”¨åŸŸ</th> <th>å¤‡æ³¨</th></tr></thead> <tbody><tr><td>DataExecModel.INSERT</td> <td>æ•°æ®æ–°å¢æ“ä½œ</td> <td></td></tr> <tr><td>DataExecModel.UPDATE</td> <td>æ•°æ®æ›´æ–°æ“ä½œ</td> <td></td></tr> <tr><td>DataExecModel.SELECT</td> <td>æ•°æ®æŸ¥è¯¢æ“ä½œ</td> <td></td></tr> <tr><td>DataExecModel.INSERTANDUPDATE</td> <td>æ•°æ®æ–°å¢æˆ–æ›´æ–°æ“ä½œ</td> <td></td></tr> <tr><td>DataExecModel.ALL</td> <td>æ•°æ®æ–°å¢|ä¿®æ”¹|æŸ¥è¯¢æ“ä½œ</td> <td></td></tr></tbody></table> <h4 id="_3-7-1-ä½¿ç”¨å†…ç½®ç®—æ³•è¿›è¡Œæ•°æ®å­—æ®µçº§åŠ è§£å¯†æ“ä½œ"><a href="#_3-7-1-ä½¿ç”¨å†…ç½®ç®—æ³•è¿›è¡Œæ•°æ®å­—æ®µçº§åŠ è§£å¯†æ“ä½œ" class="header-anchor">#</a> 3.7.1 ä½¿ç”¨å†…ç½®ç®—æ³•è¿›è¡Œæ•°æ®å­—æ®µçº§åŠ è§£å¯†æ“ä½œ</h4> <p>é…ç½®å‚æ•°å¦‚ä¸‹ï¼š</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">dataguard</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>       <span class="token comment">#å¯ç”¨ç»„ä»¶</span>
    <span class="token key atrule">trace-log</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>    <span class="token comment">#å¯ç”¨è·Ÿè¸ªæ—¥å¿—</span>
    <span class="token key atrule">encryptRulesExt</span><span class="token punctuation">:</span>  <span class="token comment">#åŠ å¯†ç®—æ³•å‚æ•°é…ç½®(å¯¹ç§°åŠ å¯†&amp;éå¯¹ç§°åŠ å¯†å‡éœ€é…ç½®)</span>
      <span class="token punctuation">-</span> <span class="token punctuation">{</span><span class="token key atrule">ruleId</span><span class="token punctuation">:</span> <span class="token string">'AES'</span><span class="token punctuation">,</span> <span class="token key atrule">ruleParams</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">key</span><span class="token punctuation">:</span> wjy59188wjy59188<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment">#å†…ç½®AESåŠ å¯†ç®—æ³•ç¤ºä¾‹(keyçš„é•¿åº¦ä¸º16ä½) </span>
      <span class="token punctuation">-</span> <span class="token punctuation">{</span><span class="token key atrule">ruleId</span><span class="token punctuation">:</span> <span class="token string">'SM4'</span><span class="token punctuation">,</span> <span class="token key atrule">ruleParams</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">key</span><span class="token punctuation">:</span> wjy59188wjy59188<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment">#å†…ç½®SM4åŠ å¯†ç®—æ³•ç¤ºä¾‹(keyçš„é•¿åº¦ä¸º16ä½) </span>
      <span class="token punctuation">-</span> <span class="token punctuation">{</span><span class="token key atrule">ruleId</span><span class="token punctuation">:</span> <span class="token string">'HMACSHA256'</span><span class="token punctuation">,</span> <span class="token key atrule">ruleParams</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">key</span><span class="token punctuation">:</span> wjy59188wjy59188<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment">#å†…ç½®HMACSHA256åŠ å¯†ç®—æ³•ç¤ºä¾‹</span>
      <span class="token punctuation">-</span> <span class="token punctuation">{</span><span class="token key atrule">ruleId</span><span class="token punctuation">:</span> <span class="token string">'RSA'</span><span class="token punctuation">,</span> <span class="token key atrule">ruleParams</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">publicKey</span><span class="token punctuation">:</span> wjy59188wjy59188<span class="token punctuation">,</span><span class="token key atrule">privateKey</span><span class="token punctuation">:</span> wjy59188wjy59188<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment">#å†…ç½®RSAåŠ å¯†ç®—æ³•ç¤ºä¾‹</span>
      <span class="token punctuation">-</span> <span class="token punctuation">{</span><span class="token key atrule">ruleId</span><span class="token punctuation">:</span> <span class="token string">'SM2'</span><span class="token punctuation">,</span> <span class="token key atrule">ruleParams</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">publicKey</span><span class="token punctuation">:</span> wjy59188wjy59188<span class="token punctuation">,</span><span class="token key atrule">privateKey</span><span class="token punctuation">:</span> wjy59188wjy59188<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment">#å†…ç½®SM2åŠ å¯†ç®—æ³•ç¤ºä¾‹ </span>
</code></pre></div><p>æ³¨ï¼šæ­¤å¤„çš„ruleIdçš„å€¼æ˜¯ç¤ºä¾‹ï¼Œå®é™…ä½¿ç”¨æ—¶éœ€è¦ä¿®æ”¹ä¸ºFieldDataGuardä¸­å®šä¹‰çš„ruleIdå¯¹åº”çš„å€¼ï¼ŒruleIdå¿…é¡»è‡ªè¡Œç¡®ä¿å…¨å±€å”¯ä¸€ï¼Œå¦åˆ™æ•°æ®è§£æä¼šæœ‰é—®é¢˜ã€‚ruleParamsä¸­çš„å‚æ•°ï¼Œä½¿ç”¨å†…ç½®ç®—æ³•æ—¶ï¼Œå‚æ•°åå¿…é¡»ä¸ºç¤ºä¾‹é…ç½®ä¸­çš„å‚æ•°åæ‰å¯ä»¥ï¼Œç›¸å…³keyçš„å€¼å¯ä»¥è‡ªå·±è‡ªå®šä¹‰ã€‚</p> <p>å¦‚æœéœ€è¦ä½¿ç”¨å›½å¯†ç®—æ³•ï¼Œéœ€è¦å¼•å…¥é¢å¤–çš„ä¾èµ–æ‰å¯ä»¥</p> <div class="language- extra-class"><pre class="language-text"><code>        &lt;dependency&gt;
            &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;
            &lt;artifactId&gt;bcprov-jdk15to18&lt;/artifactId&gt;
            &lt;version&gt;${bcprov.version}&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre></div><p>åœ¨Domainä¸­æ·»åŠ ç±»æ‰«ææ³¨è§£@ShanHaiDataGuard,åœ¨éœ€è¦æ“ä½œçš„å­—æ®µæ·»åŠ  @FieldDataGuardæ³¨è§£ï¼š</p> <p>åŠ å¯†ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ShanHaiDataGuard</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DictData</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@FieldDataGuard</span><span class="token punctuation">(</span>ruleId <span class="token operator">=</span> <span class="token string">&quot;dictLabel&quot;</span><span class="token punctuation">,</span>encrypt <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>encryptMethod <span class="token operator">=</span> <span class="token class-name">DataEncryptDef</span><span class="token punctuation">.</span><span class="token constant">SHA256</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> dictLabel<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>è§£å¯†ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ShanHaiDataGuard</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DictData</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@FieldDataGuard</span><span class="token punctuation">(</span>ruleId <span class="token operator">=</span> <span class="token string">&quot;dictLabel&quot;</span><span class="token punctuation">,</span>decrypt  <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>decryptMethod <span class="token operator">=</span> <span class="token class-name">DataEncryptDef</span><span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">,</span>decryptExecModel <span class="token operator">=</span> <span class="token class-name">DataExecModel</span><span class="token punctuation">.</span><span class="token constant">SELECT</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> dictLabel<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>@FieldDataGuard å„å­—æ®µå®šä¹‰</p> <table><thead><tr><th>å­—æ®µå®šä¹‰</th> <th>å­—æ®µç±»å‹</th> <th>å­—æ®µè¯´æ˜</th></tr></thead> <tbody><tr><td>ruleId</td> <td>String</td> <td>è§„åˆ™IDï¼Œç”¨äºè‡ªè¡Œæ ¹æ®è§„åˆ™è¿›è¡Œç›¸å…³æ‰©å±•</td></tr> <tr><td>encrypt</td> <td>boolean</td> <td>æ˜¯å¦å¯ç”¨æ•°æ®åŠ å¯†</td></tr> <tr><td>encryptMethod</td> <td>String</td> <td>åŠ å¯†ç®—æ³• é»˜è®¤ç®—æ³•é›†å‚è€ƒDataEncryptDef</td></tr> <tr><td>encryptExecModel</td> <td>String</td> <td>æ‰§è¡ŒåŠ å¯†ç®—æ³•çš„æ—¶æœº å‚è€ƒDataExecModel</td></tr> <tr><td>decrypt</td> <td>boolean</td> <td>æ˜¯å¦å¯ç”¨æ•°æ®æŸ¥è¯¢è§£å¯†</td></tr> <tr><td>decryptMethod</td> <td>String</td> <td>è§£å¯†ç®—æ³• é»˜è®¤ç®—æ³•é›†å‚è€ƒDataEncryptDef</td></tr> <tr><td>hyposensit</td> <td>boolean</td> <td>æ˜¯å¦å¯ç”¨æ•°æ®è„±æ•</td></tr> <tr><td>hyposensitMethod</td> <td>String</td> <td>æ•°æ®è„±æ•ç®—æ³• é»˜è®¤ç®—æ³•é›†å‚è€ƒDataHyposensitDef</td></tr> <tr><td>hyposensitExecModel</td> <td>String</td> <td>æ‰§è¡Œè„±æ•ç®—æ³•çš„æ—¶æœº å‚è€ƒDataExecModel</td></tr></tbody></table> <p>ShanHaiTmpDataå¯ä»¥è·å–åˆ°åŸå§‹å­—æ®µå€¼ä»¥åŠå¤„ç†è¿™ä¸ªå€¼æ‰€éœ€è¦çš„è¿è¡Œç®—æ³•åç§°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ˜¯æ—¢è¦åŠ å¯†åˆè¦è„±æ•ï¼Œåˆ™å…ˆæ‰§è¡Œè„±æ•å†æ‰§è¡ŒåŠ å¯†ã€‚å¦‚æœæ—¢è¦è§£å¯†åˆè¦è„±æ•ï¼Œåˆ™å…ˆæ‰§è¡Œè§£å¯†ç„¶åæ‰§è¡Œè„±æ•ã€‚</p> <p>åŠ è§£å¯†é»˜è®¤ç®—æ³•ï¼ˆDataEncryptDefï¼‰ï¼š</p> <p><strong>MD5/SHA256/HMACSHA256/RSA/AES/SM2/SM3/SM4</strong></p> <h4 id="_3-7-2-æ•°æ®å­—æ®µçº§è„±æ•æ“ä½œ"><a href="#_3-7-2-æ•°æ®å­—æ®µçº§è„±æ•æ“ä½œ" class="header-anchor">#</a> 3.7.2 æ•°æ®å­—æ®µçº§è„±æ•æ“ä½œ</h4> <p>é…ç½®å‚æ•°å¦‚ä¸‹ï¼š</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">dataguard</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>       <span class="token comment">#å¯ç”¨ç»„ä»¶</span>
    <span class="token key atrule">trace-log</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>    <span class="token comment">#å¯ç”¨è·Ÿè¸ªæ—¥å¿—</span>
    <span class="token key atrule">hyposensitRulesExt</span><span class="token punctuation">:</span> <span class="token comment">#è„±æ•è§„åˆ™å®šä¹‰ï¼ˆéœ€è¦è‡ªè¡Œæ‰©å±•æ—¶æ‰éœ€è¦é…ç½®ï¼Œé»˜è®¤ä¸éœ€è¦é…ç½®è¯¥æ‰©å±•ï¼‰</span>
      <span class="token punctuation">-</span> <span class="token punctuation">{</span><span class="token key atrule">ruleId</span><span class="token punctuation">:</span> <span class="token string">'yourRule'</span><span class="token punctuation">,</span><span class="token key atrule">regex</span><span class="token punctuation">:</span> <span class="token string">'([1][1-9]\d{1})\d{4}(\d{4})'</span><span class="token punctuation">,</span><span class="token key atrule">replacement</span><span class="token punctuation">:</span> <span class="token string">'$1****$2'</span><span class="token punctuation">}</span>
</code></pre></div><p>æ³¨ï¼šæ­¤å¤„çš„ruleIdçš„å€¼æ˜¯ç¤ºä¾‹ï¼Œå®é™…ä½¿ç”¨æ—¶è‡ªå·±å¯ä»¥æ”¹ä¸ºå…¶ä»–æ ‡è¯†å­—ç¬¦ä¸²å³å¯ï¼Œregexä¸ºè‡ªå®šä¹‰æ­£åˆ™ï¼Œreplacementä¸ºè„±æ•åçš„æ ¼å¼ã€‚ä½¿ç”¨çš„String.replaceAllåšè„±æ•å¤„ç†ã€‚</p> <p>è„±æ•é»˜è®¤ç®—æ³•ï¼ˆDataHyposensitDefï¼‰ï¼š</p> <p><strong>IDcard/RealName/TelPhone/email/money</strong> åˆ†åˆ«å¯¹åº”çš„æ˜¯ï¼šèº«ä»½è¯/å§“å/æ‰‹æœºå·/é‚®ç®±/é‡‘é¢</p> <p>æ•°æ®è„±æ•ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ShanHaiDataGuard</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DictData</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@FieldDataGuard</span><span class="token punctuation">(</span>ruleId <span class="token operator">=</span> <span class="token string">&quot;dictLabel&quot;</span><span class="token punctuation">,</span>hyposensit <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>hyposensitMethod <span class="token operator">=</span> <span class="token class-name">DataHyposensitDef<span class="token punctuation">.</span>IDcard</span><span class="token punctuation">,</span>hyposensitExecModel <span class="token operator">=</span> <span class="token class-name">DataExecModel</span><span class="token punctuation">.</span><span class="token constant">QUERY</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> dictLabel<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-7-3-ä½¿ç”¨è‡ªå®šä¹‰ç®—æ³•è¿›è¡Œæ•°æ®å­—æ®µçº§åŠ è§£å¯†æˆ–è„±æ•æ“ä½œ"><a href="#_3-7-3-ä½¿ç”¨è‡ªå®šä¹‰ç®—æ³•è¿›è¡Œæ•°æ®å­—æ®µçº§åŠ è§£å¯†æˆ–è„±æ•æ“ä½œ" class="header-anchor">#</a> 3.7.3 ä½¿ç”¨è‡ªå®šä¹‰ç®—æ³•è¿›è¡Œæ•°æ®å­—æ®µçº§åŠ è§£å¯†æˆ–è„±æ•æ“ä½œ</h4> <p>é…ç½®å‚æ•°å¦‚ä¸‹ï¼š</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">dataguard</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>       <span class="token comment">#å¯ç”¨ç»„ä»¶</span>
    <span class="token key atrule">encryptRulesExt</span><span class="token punctuation">:</span>  <span class="token comment">#åŠ å¯†ç®—æ³•å‚æ•°é…ç½®(è‡ªå®šä¹‰ç®—æ³•å®ç°)</span>
      <span class="token punctuation">-</span> <span class="token punctuation">{</span><span class="token key atrule">ruleId</span><span class="token punctuation">:</span> <span class="token string">'xxxxx'</span><span class="token punctuation">,</span> <span class="token key atrule">ruleParams</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">key</span><span class="token punctuation">:</span> wjy59188wjy59188<span class="token punctuation">,</span> <span class="token key atrule">iv</span><span class="token punctuation">:</span> aaaaa1111<span class="token punctuation">,</span> <span class="token key atrule">source</span><span class="token punctuation">:</span> device<span class="token punctuation">}</span><span class="token punctuation">}</span> 
</code></pre></div><p>æ­¤å¤„ruleParamså†…çš„å‚æ•°ä½ å¯ä»¥æŒ‰ç…§è‡ªå·±éœ€è¦è¿›è¡Œè‡ªå®šä¹‰ï¼Œæ­¤å¤„åªæ˜¯ä¸€ä¸ªç¤ºä¾‹ã€‚</p> <p>åœ¨è‡ªå·±çš„æ•°æ®è§£æå®ç°æ‰©å±•åŠ è§£å¯†ç®—æ³•æˆ–è€…æ•°æ®è„±æ•æ“ä½œã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XXXDataGuardServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">DefaultDataGuardServiceImpl</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">DataGuardConfig</span> shanhaiDataGuardConfig<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">XXXDataGuardServiceImpl</span><span class="token punctuation">(</span><span class="token class-name">DataGuardConfig</span> shanhaiDataGuardConfig<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>shanhaiDataGuardConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token class-name">ShanHaiTmpData</span> shanHaiTmpData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//TODO å¯ä»¥åœ¨æ­¤å¤„æ‰©å±•è‡ªå®šä¹‰åŠ å¯†ç®—æ³•å®ç°</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>shanHaiTmpData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token class-name">ShanHaiTmpData</span> shanHaiTmpData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//TODO å¯ä»¥åœ¨æ­¤å¤„æ‰©å±•è‡ªå®šä¹‰è§£å¯†ç®—æ³•å®ç°</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>shanHaiTmpData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>è‡ªå·±å®šä¹‰çš„åŠ è§£å¯†ç®—æ³•çš„é…ç½®å‚æ•°å¯ä»¥ä»DataGuardConfig-&gt;encryptRulesExt-&gt;EncryptRuleä¸­è·å–ï¼ŒruleParamsåœ¨EncryptRuleä¸­ä»¥Mapçš„å½¢å¼å­˜åœ¨ã€‚å¯¹äºDomainå¯¹è±¡ä¸­çš„ruleIdä»¥åŠåŸå§‹å­—æ®µæ•°æ®å¯ä»¥ä»ShanHaiTmpDataä¸­è·å–ã€‚</p> <p>å¯¹äºè„±æ•ï¼Œæš‚ä¸æ”¯æŒé…ç½®è‡ªå®šä¹‰è„±æ•ç®—æ³•ã€‚éœ€è¦å®ç°çš„å¯ä»¥è‡ªå·±é‡å†™hyposensitçš„å®ç°ã€‚</p> <h3 id="_3-8åŸºäºåºåˆ—åŒ–çš„å“åº”æŠ¥æ–‡æ•°æ®è„±æ•"><a href="#_3-8åŸºäºåºåˆ—åŒ–çš„å“åº”æŠ¥æ–‡æ•°æ®è„±æ•" class="header-anchor">#</a> 3.8åŸºäºåºåˆ—åŒ–çš„å“åº”æŠ¥æ–‡æ•°æ®è„±æ•</h3> <p>é…ç½®å‚æ•°å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>shanhai:
  respguard:
    enable: true       #å¯ç”¨ç»„ä»¶
</code></pre></div><p>åœ¨å“åº”æŠ¥æ–‡VOå¯¹è±¡ä¸­éœ€è¦è¿›è¡Œè„±æ•çš„å­—æ®µï¼Œæ·»åŠ æ³¨è§£ @RespFieldGuardå¹¶å¢åŠ è§„åˆ™å®šä¹‰ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RespInfo</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@RespFieldGuard</span><span class="token punctuation">(</span>ruleId <span class="token operator">=</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> text<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å®ç°RespGuardRuleDefServiceæ¥å£ï¼Œå®ç°è‡ªå·±çš„è„±æ•ç®—æ³•é›†åˆï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OpenRespGuardRuleDefService</span> <span class="token keyword">implements</span> <span class="token class-name">RespGuardRuleDefService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">jsonGenerator</span><span class="token punctuation">(</span><span class="token class-name">String</span> ruleId<span class="token punctuation">,</span> <span class="token class-name">Object</span> fieldValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>fieldValue<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;@&quot;</span><span class="token operator">+</span>ruleId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ³¨ï¼šæ­¤å¤„åªæ˜¯åšäº†é€šç”¨æ€§å°è£…ï¼Œæ²¡æœ‰å†…ç½®ä»»ä½•è„±æ•ç®—æ³•ï¼Œç›¸å…³è§„åˆ™éœ€è¦è‡ªå·±æ¥å®ç°ã€‚</p> <h3 id="_3-9é€šç”¨å“åº”æŠ¥æ–‡ç¼–ç ç»„ä»¶"><a href="#_3-9é€šç”¨å“åº”æŠ¥æ–‡ç¼–ç ç»„ä»¶" class="header-anchor">#</a> 3.9é€šç”¨å“åº”æŠ¥æ–‡ç¼–ç ç»„ä»¶</h3> <h4 id="_3-5-1-å…¨é‡è¯·æ±‚è§£ç -2"><a href="#_3-5-1-å…¨é‡è¯·æ±‚è§£ç -2" class="header-anchor">#</a> 3.5.1 å…¨é‡è¯·æ±‚è§£ç </h4> <p>é…ç½®å‚æ•°å¦‚ä¸‹</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">encodebody</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#å¯ç”¨ç»„ä»¶</span>
</code></pre></div><p>æ³¨ï¼šæ­¤ç»„ä»¶åªæ˜¯åšäº†é€šç”¨æ€§å°è£…ï¼Œå¯¹äºç¼–ç é€»è¾‘éœ€è¦è‡ªè¡Œå®ç°æ¥å£EncodeBodyServiceçš„encodeRespBodyæ–¹æ³•ï¼Œåœ¨è¿›è¡Œæ•°æ®ç¼–ç æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ¥å£çš„å®ç°æ–¹æ³•è¿›è¡Œè‡ªå®šä¹‰å‚æ•°ç¼–ç æ“ä½œã€‚</p> <p>æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token comment">/**
     * åŠ å¯†å“åº”
     * @param body åŸå§‹å“åº”æŠ¥æ–‡
     * @return
     */</span>
    <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">encodeRespBody</span><span class="token punctuation">(</span><span class="token class-name">String</span> body<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> body<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>å¦‚æœéœ€è¦æŸä¸ªè¯·æ±‚ä¸è¿›è¡Œè§£ç æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨æ³¨è§£@EncodeBodyIgnoreè·³è¿‡å¯¹ç›®æ ‡è¯·æ±‚çš„è§£ç æ“ä½œã€‚</p> <h4 id="_3-5-2-æŒ‡å®šè¯·æ±‚è§£ç -2"><a href="#_3-5-2-æŒ‡å®šè¯·æ±‚è§£ç -2" class="header-anchor">#</a> 3.5.2 æŒ‡å®šè¯·æ±‚è§£ç </h4> <p>é…ç½®å‚æ•°å¦‚ä¸‹</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">encodebody</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#å¯ç”¨ç»„ä»¶</span>
    <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token number">2</span>      <span class="token comment">#æŒ‡å®šè¯·æ±‚åŠ å¯†æ¨¡å¼ï¼Œé»˜è®¤ä¸ºå…¨é‡åŠ å¯† mode:1</span>
</code></pre></div><p>ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EncodeBody</span><span class="token punctuation">(</span>ruleId <span class="token operator">=</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">JSONObject</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">&quot;demoxx&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ³¨ï¼šæ­¤ç»„ä»¶åªæ˜¯åšäº†é€šç”¨æ€§å°è£…ï¼Œå¯¹äºç¼–ç é€»è¾‘éœ€è¦è‡ªè¡Œå®ç°æ¥å£EncodeBodyServiceçš„encodeRespBodyæ–¹æ³•ï¼Œåœ¨è¿›è¡Œæ•°æ®ç¼–ç æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ¥å£çš„å®ç°æ–¹æ³•è¿›è¡Œè‡ªå®šä¹‰å‚æ•°ç¼–ç æ“ä½œã€‚</p> <p>æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code>     <span class="token comment">/**
     * æŒ‰ç…§è‡ªå®šä¹‰è§„åˆ™IDåŠ å¯†å“åº”æŠ¥æ–‡
     * @param ruleId è§„åˆ™ID
     * @param body åŸå§‹æŠ¥æ–‡
     * @return
     */</span>
    <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">encodeRespBody</span><span class="token punctuation">(</span><span class="token class-name">String</span> ruleId<span class="token punctuation">,</span><span class="token class-name">String</span> body<span class="token punctuation">)</span>
</code></pre></div><p>ç”¨æˆ·æ ¹æ®ruleIdè¿›è¡Œä¸ªæ€§åŒ–ç¼–ç ç»„ä»¶å¼€å‘ã€‚</p> <h3 id="_3-10-æ•æ„Ÿè¯æ£€æµ‹è¿‡æ»¤ç»„ä»¶"><a href="#_3-10-æ•æ„Ÿè¯æ£€æµ‹è¿‡æ»¤ç»„ä»¶" class="header-anchor">#</a> 3.10 æ•æ„Ÿè¯æ£€æµ‹è¿‡æ»¤ç»„ä»¶</h3> <p>é…ç½®å‚æ•°å¦‚ä¸‹</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shanhai</span><span class="token punctuation">:</span>
  <span class="token key atrule">sensitivewords</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">sensitive-filter-mode</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token comment">#æ•æ„Ÿè¯è¿‡æ»¤æ¨¡å¼ ï¼ˆ1:è‡ªåŠ¨è„±æ•æ”¾è¡Œ 2:æ‹’ç»æ‰§è¡Œï¼‰</span>
    <span class="token key atrule">path-patterns</span><span class="token punctuation">:</span> <span class="token comment">#æ•æ„Ÿè¯æ£€æµ‹èŒƒå›´</span>
      <span class="token punctuation">-</span> <span class="token string">'/*'</span>
    <span class="token key atrule">sensitive-words</span><span class="token punctuation">:</span> <span class="token string">&quot;ä»Šå¤©, ä»Šå¤©å¾ˆå¥½, ä»Šå¤©çœŸçƒ¦&quot;</span> <span class="token comment">#æ•æ„Ÿè¯æ¸…å•ï¼ˆå¤šä¸ªä»¥è‹±æ–‡,åˆ†éš”ï¼‰</span>
    <span class="token key atrule">task-enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#æ˜¯å¦å¯ç”¨å®šæ—¶æ›´æ–°æ•æ„Ÿè¯è¯åº“ä»»åŠ¡</span>
    <span class="token key atrule">task-inteval-period</span><span class="token punctuation">:</span> <span class="token number">60</span> <span class="token comment">#å®šæ—¶æ›´æ–°é¢‘ç‡ ï¼ˆå•ä½:ç§’ï¼Œé»˜è®¤å€¼ï¼š600sï¼‰</span>
</code></pre></div><p>å±±æµ·Guardæ•æ„Ÿè¯æ£€æµ‹ç»„ä»¶ä½¿ç”¨DFAç®—æ³•å¯¹æ•æ„Ÿè¯è¿›è¡Œæ£€æµ‹ï¼Œæ”¯æŒé€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œæ•æ„Ÿè¯é…ç½®ï¼ŒåŒæ—¶æ”¯æŒå®šæ—¶æ›´æ–°æ•æ„Ÿè¯è¯åº“é…ç½®èƒ½åŠ›ã€‚</p> <p>å¦‚æœå¯ç”¨å®šæ—¶æ›´æ–°æ•æ„Ÿè¯è¯åº“ä»»åŠ¡ï¼Œåˆ™éœ€è¦è‡ªè¡Œå®ç°å¦‚ä¸‹æ¥å£,åŠ¨æ€åŠ è½½æ•æ„Ÿè¯æ•°æ®ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SensitiveWordsDictService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">loadDict</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-11-å¸¸è§é—®é¢˜"><a href="#_3-11-å¸¸è§é—®é¢˜" class="header-anchor">#</a> 3.11 å¸¸è§é—®é¢˜</h3> <h4 id="_3-11-1-æ–‡ä»¶ä¸Šä¼ æ£€æµ‹ä¸ç”Ÿæ•ˆ"><a href="#_3-11-1-æ–‡ä»¶ä¸Šä¼ æ£€æµ‹ä¸ç”Ÿæ•ˆ" class="header-anchor">#</a> 3.11.1 æ–‡ä»¶ä¸Šä¼ æ£€æµ‹ä¸ç”Ÿæ•ˆ</h4> <p>åœ¨springbootä¸­ä½¿ç”¨å¤šä¸ªç»§æ‰¿WebMvcConfigurationSupportçš„ç±»æ˜¯è¡Œä¸é€šçš„ï¼Œè€Œä¸”ä½¿ç”¨æ³¨è§£@configurationå»åŠ è½½é…ç½®ç±»åªèƒ½æŒ‚è½½ä¸€ä¸ªç»§æ‰¿WebMvcConfigurationSupportã€‚</p> <p>è§£å†³åŠæ³•ï¼šè‡ªå·±é¡¹ç›®ä¸­çš„webmvcé…ç½®è¦å®ç° webMvcConfigurer æ¥å£è€Œä¸èƒ½ä½¿ç”¨ç»§æ‰¿WebMvcConfigurationSupportç±»çš„æ–¹å¼ï¼Œè¿™æ ·ç»„ä»¶å’Œè‡ªå·±é¡¹ç›®ä¸­çš„webmvcéƒ½å¯ä»¥æŒ‚è½½ã€‚</p> <p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XXXConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-ac050c62><li class="level-2" data-v-ac050c62><a href="/guard/#ç»„ä»¶èƒ½åŠ›" class="sidebar-link reco-side-ç»„ä»¶èƒ½åŠ›" data-v-ac050c62>ç»„ä»¶èƒ½åŠ›</a></li><li class="level-2" data-v-ac050c62><a href="/guard/#_1-å¼•å…¥ä¾èµ–" class="sidebar-link reco-side-_1-å¼•å…¥ä¾èµ–" data-v-ac050c62>1.å¼•å…¥ä¾èµ–</a></li><li class="level-2" data-v-ac050c62><a href="/guard/#_2-å¯ç”¨shanhaiguardå®‰å…¨é˜²æŠ¤ç»„ä»¶" class="sidebar-link reco-side-_2-å¯ç”¨shanhaiguardå®‰å…¨é˜²æŠ¤ç»„ä»¶" data-v-ac050c62>2.å¯ç”¨ShanHaiGuardå®‰å…¨é˜²æŠ¤ç»„ä»¶</a></li><li class="level-2" data-v-ac050c62><a href="/guard/#_3-ç»„ä»¶è¯´æ˜" class="sidebar-link reco-side-_3-ç»„ä»¶è¯´æ˜" data-v-ac050c62>3.ç»„ä»¶è¯´æ˜</a></li><li class="level-3" data-v-ac050c62><a href="/guard/#_3-1-æ–‡ä»¶ä¸Šä¼ æ£€æµ‹" class="sidebar-link reco-side-_3-1-æ–‡ä»¶ä¸Šä¼ æ£€æµ‹" data-v-ac050c62>3.1 æ–‡ä»¶ä¸Šä¼ æ£€æµ‹</a></li><li class="level-3" data-v-ac050c62><a href="/guard/#_3-2-å¯†ç å¤æ‚åº¦æ£€æµ‹" class="sidebar-link reco-side-_3-2-å¯†ç å¤æ‚åº¦æ£€æµ‹" data-v-ac050c62>3.2 å¯†ç å¤æ‚åº¦æ£€æµ‹</a></li><li class="level-3" data-v-ac050c62><a href="/guard/#_3-3-sql-xssæ³¨å…¥æ£€æµ‹" class="sidebar-link reco-side-_3-3-sql-xssæ³¨å…¥æ£€æµ‹" data-v-ac050c62>3.3 SQL&amp;XSSæ³¨å…¥æ£€æµ‹</a></li><li class="level-3" data-v-ac050c62><a href="/guard/#_3-4-mysqlæ•°æ®å®‰å…¨æ£€æµ‹" class="sidebar-link reco-side-_3-4-mysqlæ•°æ®å®‰å…¨æ£€æµ‹" data-v-ac050c62>3.4 Mysqlæ•°æ®å®‰å…¨æ£€æµ‹</a></li><li class="level-3" data-v-ac050c62><a href="/guard/#_3-5-requestbody-é€šç”¨è§£ç ç»„ä»¶" class="sidebar-link reco-side-_3-5-requestbody-é€šç”¨è§£ç ç»„ä»¶" data-v-ac050c62>3.5 @RequestBody é€šç”¨è§£ç ç»„ä»¶</a></li><li class="level-3" data-v-ac050c62><a href="/guard/#_3-6-springbooté…ç½®æ–‡ä»¶å‚æ•°åŠ å¯†" class="sidebar-link reco-side-_3-6-springbooté…ç½®æ–‡ä»¶å‚æ•°åŠ å¯†" data-v-ac050c62>3.6 SpringBooté…ç½®æ–‡ä»¶å‚æ•°åŠ å¯†</a></li><li class="level-3" data-v-ac050c62><a href="/guard/#_3-7-åŸºäºmybatis-plusè¿›è¡Œå­—æ®µçº§åŠ è§£å¯†ä¸æ•°æ®è„±æ•" class="sidebar-link reco-side-_3-7-åŸºäºmybatis-plusè¿›è¡Œå­—æ®µçº§åŠ è§£å¯†ä¸æ•°æ®è„±æ•" data-v-ac050c62>3.7 åŸºäºMybatis-Plusè¿›è¡Œå­—æ®µçº§åŠ è§£å¯†ä¸æ•°æ®è„±æ•</a></li><li class="level-3" data-v-ac050c62><a href="/guard/#_3-8åŸºäºåºåˆ—åŒ–çš„å“åº”æŠ¥æ–‡æ•°æ®è„±æ•" class="sidebar-link reco-side-_3-8åŸºäºåºåˆ—åŒ–çš„å“åº”æŠ¥æ–‡æ•°æ®è„±æ•" data-v-ac050c62>3.8åŸºäºåºåˆ—åŒ–çš„å“åº”æŠ¥æ–‡æ•°æ®è„±æ•</a></li><li class="level-3" data-v-ac050c62><a href="/guard/#_3-9é€šç”¨å“åº”æŠ¥æ–‡ç¼–ç ç»„ä»¶" class="sidebar-link reco-side-_3-9é€šç”¨å“åº”æŠ¥æ–‡ç¼–ç ç»„ä»¶" data-v-ac050c62>3.9é€šç”¨å“åº”æŠ¥æ–‡ç¼–ç ç»„ä»¶</a></li><li class="level-3" data-v-ac050c62><a href="/guard/#_3-10-æ•æ„Ÿè¯æ£€æµ‹è¿‡æ»¤ç»„ä»¶" class="sidebar-link reco-side-_3-10-æ•æ„Ÿè¯æ£€æµ‹è¿‡æ»¤ç»„ä»¶" data-v-ac050c62>3.10 æ•æ„Ÿè¯æ£€æµ‹è¿‡æ»¤ç»„ä»¶</a></li><li class="level-3" data-v-ac050c62><a href="/guard/#_3-11-å¸¸è§é—®é¢˜" class="sidebar-link reco-side-_3-11-å¸¸è§é—®é¢˜" data-v-ac050c62>3.11 å¸¸è§é—®é¢˜</a></li></ul></main></div> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.70ce5912.js" defer></script><script src="/assets/js/3.9490caa6.js" defer></script><script src="/assets/js/1.ef43800b.js" defer></script><script src="/assets/js/13.0082dea9.js" defer></script>
  </body>
</html>
